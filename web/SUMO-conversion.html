<!DOCTYPE html>
<html>

<head>
    <title>Conversion</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/css/SUMO-conversion.css">
</head>

<body>
    <h1>Elige una ciudad</h1>
    <select class="form-control" id="citySelect">
        <option value="">Selecciona la ciudad</option>
        <option value="madrid">Madrid</option>
        <option value="barcelona">Barcelona</option>
        <option value="santander">Santander</option>
    </select>
    <br>
    <div class="center-div">
        <div class="btn-group" role="group" aria-label="Button group">
            <button class="btn btn-primary" id="nextButton">Siguiente</button>
            <a href="/" class="btn btn-secondary">Volver</a>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        $(document).ready(function () {
            // Add a click event listener to the "nextButton"
            $('#nextButton').click(function () {
                // Get the selected city from the dropdown menu
                var city = $('#citySelect').val();

                // Send a POST request to the "/SUMO-conversion" endpoint
                $.ajax({
                    url: '/SUMO-conversion',
                    type: 'POST',
                    data: JSON.stringify({ city: city }),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    async: false,
                    success: function (msg) {
                        alert('Se han convertido los datos de ' + city + ' a FIWARE correctamente.');
                        window.location.href = '/cities/' + city;
                    }
                });
            });
        });
    </script>
</body>

</html>